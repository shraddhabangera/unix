create database VP21MC042_Tour;

use VP21MC042_Tour;
Database changed
mysql> create table Tourist
    -> (
    -> tId int(5)PRIMARY KEY,
    -> tName varchar(20)NOT NULL,
    -> age int(4),
    -> country varchar(20)NOT NULL);
Query OK, 0 rows affected, 2 warnings (0.01 sec)

mysql> desc Tourist;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| tId     | int         | NO   | PRI | NULL    |       |
| tName   | varchar(20) | NO   |     | NULL    |       |
| age     | int         | YES  |     | NULL    |       |
| country | varchar(20) | NO   |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+


create table TouristPlace
    -> (
    -> tpId int(5)PRIMARY KEY,
    -> tpName varchar(20)NOT NULL,
    -> state varchar(20)NOT NULL,
    -> KM int(10),
    -> history varchar(20));
Query OK, 0 rows affected, 2 warnings (0.02 sec)

mysql> desc TouristPlace;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| tpId    | int         | NO   | PRI | NULL    |       |
| tpName  | varchar(20) | NO   |     | NULL    |       |
| state   | varchar(20) | NO   |     | NULL    |       |
| KM      | int         | YES  |     | NULL    |       |
| history | varchar(20) | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+



create table Visit
    -> (
    -> tId int(5)NOT NULL,
    -> tpId int(5)NOT NULL,
    -> vDate date,
    -> foreign key(tId)references Tourist(tId),
    -> foreign key(tpId)references TouristPlace(tpId));
Query OK, 0 rows affected, 2 warnings (0.03 sec)

mysql> desc Visit;
+-------+------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-------+------+------+-----+---------+-------+
| tId   | int  | NO   | MUL | NULL    |       |
| tpId  | int  | NO   | MUL | NULL    |       |
| vDate | date | YES  |     | NULL    |       |
+-------+------+------+-----+---------+-------+

create table Email
    -> (
    -> tId int(5)NOT NULL,
    -> emailId varchar(40)NOT NULL UNIQUE);
Query OK, 0 rows affected, 1 warning (0.02 sec)

mysql> desc Email;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| tId     | int         | NO   |     | NULL    |       |
| emailId | varchar(40) | NO   | PRI | NULL    |       |
+---------+-------------+------+-----+---------+-------+


desc Tourist;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| tId     | int         | NO   | PRI | NULL    |       |
| tName   | varchar(20) | NO   |     | NULL    |       |
| age     | int         | YES  |     | NULL    |       |
| country | varchar(20) | NO   |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)

mysql> insert into Tourist values(T1,"Ankush",27,"India");
ERROR 1054 (42S22): Unknown column 'T1' in 'field list'
mysql> insert into Tourist values(1,"Ankush",27,"India");
Query OK, 1 row affected (0.00 sec)

mysql> insert into Tourist values(2,"Margi",23,"France");
Query OK, 1 row affected (0.00 sec)

mysql> insert into Tourist values(3,"Huwan",35,"China");
Query OK, 1 row affected (0.00 sec)

mysql> insert into Tourist values(4,"Preesha",25,"India");
Query OK, 1 row affected (0.01 sec)

mysql> insert into Tourist values(5,"Tom",34,"US");
Query OK, 1 row affected (0.00 sec)

mysql> insert into Tourist values(6,"Yukthi",31,"India");
Query OK, 1 row affected (0.01 sec)

mysql> insert into Tourist values(7,"Udani",26,"SriLanka");
Query OK, 1 row affected (0.00 sec)

select * from Tourist;
+-----+---------+------+----------+
| tId | tName   | age  | country  |
+-----+---------+------+----------+
|   1 | Ankush  |   27 | India    |
|   2 | Margi   |   23 | France   |
|   3 | Huwan   |   35 | China    |
|   4 | Preesha |   25 | India    |
|   5 | Tom     |   34 | US       |
|   6 | Yukthi  |   31 | India    |
|   7 | Udani   |   26 | SriLanka |
+-----+---------+------+----------+



desc TouristPlace;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| tpId    | int         | NO   | PRI | NULL    |       |
| tpName  | varchar(20) | NO   |     | NULL    |       |
| state   | varchar(20) | NO   |     | NULL    |       |
| KM      | int         | YES  |     | NULL    |       |
| history | varchar(20) | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
5 rows in set (0.01 sec)

mysql> insert into TouristPlace values(11,"Mysore_Palace","Karnataka",160,"Architecture");
Query OK, 1 row affected (0.00 sec)

mysql> insert into TouristPlace values(12,"Hampi","Karnataka",100,"Cultural");
Query OK, 1 row affected (0.01 sec)

mysql> insert into TouristPlace values(13,"Jog_Falls","Karnataka",100,"Waterfall");
Query OK, 1 row affected (0.00 sec)

mysql> insert into TouristPlace values(14,"Agonda","Goa",100,"Beach");
Query OK, 1 row affected (0.01 sec)

mysql> insert into TouristPlace values(15,"Eravikulam_park","Kerala",2500,"Views");
Query OK, 1 row affected (0.00 sec)

mysql> insert into TouristPlace values(16,"Agarthala","Tripura",230,"Palace");
Query OK, 1 row affected (0.00 sec)

mysql> insert into TouristPlace values(17,"Udaipur","Tripura",257,"Ancient_Temple");
Query OK, 1 row affected (0.01 sec)

insert into TouristPlace values(18,"Aga_temp","Tripura",230,"Beauty");
Query OK, 1 row affected (0.01 sec)

select * from TouristPlace;
+------+-----------------+-----------+------+----------------+
| tpId | tpName          | state     | KM   | history        |
+------+-----------------+-----------+------+----------------+
|   11 | Mysore_Palace   | Karnataka |  160 | Architecture   |
|   12 | Hampi           | Karnataka |  100 | Cultural       |
|   13 | Jog_Falls       | Karnataka |  100 | Waterfall      |
|   14 | Agonda          | Goa       |  100 | Beach          |
|   15 | Eravikulam_park | Kerala    | 2500 | Views          |
|   16 | Agarthala       | Tripura   |  230 | Palace         |
|   17 | Udaipur         | Tripura   |  257 | Ancient_Temple |
|   18 | Aga_temp        | Tripura   |  230 | Beauty         |
+------+-----------------+-----------+------+----------------+


desc Visit;
+-------+------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-------+------+------+-----+---------+-------+
| tId   | int  | NO   | MUL | NULL    |       |
| tpId  | int  | NO   | MUL | NULL    |       |
| vDate | date | YES  |     | NULL    |       |
+-------+------+------+-----+---------+-------+
insert into Visit values(1,14,'2021-04-15');
Query OK, 1 row affected (0.00 sec)

mysql> insert into Visit values(3,14,'2021-08-12');
Query OK, 1 row affected (0.00 sec)

mysql> insert into Visit values(6,14,'2019-10-14');
Query OK, 1 row affected (0.00 sec)

mysql> insert into Visit values(4,14,'2019-02-24');
Query OK, 1 row affected (0.00 sec)

mysql> insert into Visit values(7,13,'2019-08-20');
Query OK, 1 row affected (0.00 sec)

mysql> insert into Visit values(7,14,'2020-08-20');
Query OK, 1 row affected (0.01 sec)

mysql> insert into Visit values(7,11,'2020-05-10');
Query OK, 1 row affected (0.01 sec)

mysql> insert into Visit values(7,12,'2021-05-25');
Query OK, 1 row affected (0.01 sec)

mysql> insert into Visit values(7,15,'2021-02-08');
Query OK, 1 row affected (0.00 sec)

mysql> insert into Visit values(7,16,'2020-03-18');
Query OK, 1 row affected (0.01 sec)

mysql> insert into Visit values(7,17,'2022-04-28');
Query OK, 1 row affected (0.01 sec)

mysql> insert into Visit values(2,14,'2022-03-28');
Query OK, 1 row affected (0.01 sec)

mysql> insert into Visit values(5,14,'2021-03-20');
Query OK, 1 row affected (0.06 sec)

mysql> insert into Visit values(2,14,'2020-07-24');
Query OK, 1 row affected (0.00 sec)
 select * from Visit;
+-----+------+------------+
| tId | tpId | vDate      |
+-----+------+------------+
|   1 |   14 | 2021-04-15 |
|   3 |   14 | 2021-08-12 |
|   6 |   14 | 2019-10-14 |
|   4 |   14 | 2019-02-24 |
|   7 |   13 | 2019-08-20 |
|   7 |   14 | 2020-08-20 |
|   7 |   11 | 2020-05-10 |
|   7 |   12 | 2021-05-25 |
|   7 |   15 | 2021-02-08 |
|   7 |   16 | 2020-03-18 |
|   7 |   17 | 2022-04-28 |
|   2 |   14 | 2022-03-28 |
|   5 |   14 | 2021-03-20 |
|   2 |   14 | 2020-07-24 |
+-----+------+------------+


desc Email;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| tId     | int         | NO   |     | NULL    |       |
| emailId | varchar(40) | NO   | PRI | NULL    |       |
+---------+-------------+------+-----+---------+-------+
2 rows in set (0.01 sec)

mysql> insert into Email values(1,"Ankush1@gmail.com");
Query OK, 1 row affected (0.00 sec)

mysql> insert into Email values(2,"Margi25@gmail.com");
Query OK, 1 row affected (0.00 sec)

mysql> insert into Email values(3,"Huwan6@gmail.com");
Query OK, 1 row affected (0.00 sec)

mysql> insert into Email values(4,"Preesha78@gmail.com");
Query OK, 1 row affected (0.00 sec)

mysql> insert into Email values(5,"Tom254@gmail.com");
Query OK, 1 row affected (0.01 sec)

mysql> insert into Email values(6,"Yukthi54@gmail.com");
Query OK, 1 row affected (0.01 sec)

mysql> insert into Email values(7,"udani245@gmail.com");
Query OK, 1 row affected (0.00 sec)

mysql> insert into Email values(7,"udani5@gmail.com");
Query OK, 1 row affected (0.00 sec)
 select * from Email;
+-----+---------------------+
| tId | emailId             |
+-----+---------------------+
|   1 | Ankush1@gmail.com   |
|   3 | Huwan6@gmail.com    |
|   2 | Margi25@gmail.com   |
|   4 | Preesha78@gmail.com |
|   5 | Tom254@gmail.com    |
|   7 | udani245@gmail.com  |
|   7 | udani5@gmail.com    |
|   6 | Yukthi54@gmail.com  |
+-----+---------------------+


i. List the state name which is having maximum number of tourist places.
 select state,count(tpId) from TouristPlace group by state order by count(tpId) desc limit 1;
+-----------+-------------+
| state     | count(tpId) |
+-----------+-------------+
| Karnataka |           3 |
+-----------+-------------+
or
 select state from TouristPlace group by state having count(*)=(select count(*) from TouristPlace group by state order by count(state) desc limit 1);
+-----------+
| state     |
+-----------+
| Karnataka |
| Tripura   |
+-----------+


ii. List details of Tourist place where maximum number of tourists visited.
select * from TouristPlace where tpId =(select tpId from Visit group by tpId order by count(tpId) desc limit 1);
+------+--------+-------+------+---------+
| tpId | tpName | state | KM   | history |
+------+--------+-------+------+---------+
|   14 | Agonda | Goa   |  100 | Beach   |
+------+--------+-------+------+---------+
1 row in set (0.00 sec)
or
mysql> select tpId,tpName,state,count(tId) from TouristPlace,Visit where Visit.tpId=TouristPlace.tpId group by Visit.tpId order by count(Visit.tpId) desc limit 1;

